
<!DOCTYPE html>

<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Debugging with GDB &#8212; PHP 内幕</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="canonical" href="https://phpinternals.kuphp.co/php7/debugging.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Introduction" href="../php5/introduction.html" />
    <link rel="prev" title="Zend opcache" href="zend_engine/zend_opcache.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>PHP 内幕</span></a></h1>
        <h2 class="heading"><span>Debugging with GDB</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="zend_engine/zend_opcache.html">Zend opcache</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">目录</a>
        &#160;&#160;::&#160;&#160;
        <a href="../php5/introduction.html">Introduction</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="debugging-with-gdb">
<h1>Debugging with GDB<a class="headerlink" href="#debugging-with-gdb" title="此标题的永久链接">¶</a></h1>
<p>This chapter will introduce you with the GNU C debugger, aka GDB. When a crash happens, you usually have to find the
guilty part in thousands of lines. You need tools for that, and GDB is the most commonly used debugger under Unix
platforms. Here we’ll give you an introduction to GDB and how to practice with it against the PHP source code.</p>
<section id="debug-symbols">
<h2>Debug symbols<a class="headerlink" href="#debug-symbols" title="此标题的永久链接">¶</a></h2>
<p>GDB requires debug symbols to map the memory addresses in your binary to the original position in your source code. To
generate debug symbols you need to pass the <code class="docutils literal notranslate"><span class="pre">--enable-debug</span></code> flag to the <code class="docutils literal notranslate"><span class="pre">./configure</span></code> script. To get even more
debugging information you may add the <code class="docutils literal notranslate"><span class="pre">CFLAGS=&quot;-ggdb3&quot;</span></code> flag which will add support for macros.</p>
</section>
<section id="debugging-the-vm">
<h2>Debugging the VM<a class="headerlink" href="#debugging-the-vm" title="此标题的永久链接">¶</a></h2>
<p>The VM lives in the big <code class="docutils literal notranslate"><span class="pre">zend_vm_execute.h</span></code> file that is generated by <code class="docutils literal notranslate"><span class="pre">zend_vm_gen.php</span></code> from <code class="docutils literal notranslate"><span class="pre">zend_vm_def.h</span></code>.
Debugging this file can be tedious because it is very large, and it’s often not obvious which specialized handler
will run. Luckily, it is possible to debug <code class="docutils literal notranslate"><span class="pre">zend_vm_def.h</span></code> directly by generating the VM using the
<code class="docutils literal notranslate"><span class="pre">php</span> <span class="pre">Zend/zend_vm_gen.php</span> <span class="pre">--with-lines</span></code> command. This will annotate the code with the <code class="docutils literal notranslate"><span class="pre">#line</span></code> preprocessor directive
to allow the debugger to know the origin of the generated instructions.</p>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="zend_engine/zend_opcache.html">Zend opcache</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">目录</a>
        &#160;&#160;::&#160;&#160;
        <a href="../php5/introduction.html">Introduction</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer feedback">
        本书籍的存储库位于 <a href="https://github.com/mowangjuanzi/PHP-Internals-Book-zh-hans">GitHub</a>。
        <br/><br/>
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
            <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
        </a>
        <br />
        PHP 内幕根据<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际</a>获得许可。
    </div>
    <script>
<!--      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){-->
<!--      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),-->
<!--      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)-->
<!--      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');-->

<!--      ga('create', 'UA-41617167-1', 'phpinternalsbook.com');-->
<!--      ga('send', 'pageview');-->
    </script>

  </body>
</html>